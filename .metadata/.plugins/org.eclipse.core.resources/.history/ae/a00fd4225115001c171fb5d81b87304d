package com.demo.controllers;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.core.ParameterizedTypeReference;
import org.springframework.http.HttpEntity;
import org.springframework.http.HttpMethod;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.client.RestTemplate;

import com.demo.models.Flight;

@RestController
public class AdminController {

	@Autowired
	private RestTemplate restTemplate;

	/*
	 * @Autowired private AdminService adminService;
	 */

	/*
	 * @RequestMapping(value = "/login", method = RequestMethod.GET, produces =
	 * "application/json", consumes = "application/json")
	 * 
	 * public HashMap<String, Object> getLogin(@RequestBody AdminDto admin) {
	 * HashMap<String, Object> map = new HashMap<>(); UserDetails sucessOrFailure =
	 * adminService.getVerification(admin); if
	 * (sucessOrFailure.equals("Admin Login Successful")) { map.put("success",
	 * sucessOrFailure);
	 * 
	 * } else { map.put("failure", sucessOrFailure); } return map; }
	 */

	@PostMapping("/add")
	public String addFlight(@RequestBody Flight flight) {
		System.out.println("In Flight Controller, finding all flight from Flight service");
		ResponseEntity<String> res = restTemplate.exchange("http://localhost:9091/v2/api/flight/add",
				// "http://FLIGHT-SERVICE/",
				HttpMethod.POST, new HttpEntity(flight), new ParameterizedTypeReference<String>() {
				});
		return res.getBody();
	}

	@GetMapping("/search")
	public List<Flight> searchFlight() {
		System.out.println("Search in Admin Module");
		ResponseEntity<List<Flight>> res = restTemplate.exchange("http://localhost:9091/v2/api/flight/search",
				HttpMethod.GET, new HttpEntity(null), new ParameterizedTypeReference<List<Flight>>() {
				});
		return res.getBody();
	}

	@DeleteMapping("/delete")
	public String deleteFlight() {
		System.out.println("delete in Admin Module");
		ResponseEntity<String> res = restTemplate.exchange("http://localhost:9091/v2/api/flight/delete",
				HttpMethod.DELETE, new HttpEntity(null), new ParameterizedTypeReference<String>() {
				});
		return res.getBody();
	}

	@PostMapping("/blockFlight")
	public String blockFlight() {
		System.out.println("block flight in Admin Module");
		ResponseEntity<String> res = restTemplate.exchange("http://localhost:9091/v2/api/flight/blockFlight",
				HttpMethod.POST, new HttpEntity(null), new ParameterizedTypeReference<String>() {
				});
		return res.getBody();
	}
}
